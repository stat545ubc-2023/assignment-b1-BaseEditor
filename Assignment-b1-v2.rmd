---
title: "Assignment-B1-2"
output: html_document
date: "2023-11-03"
---
---

#Stats 545B Assignment B-1

The code and explanations following are intended to fulfil requirements for Stats545B assignment B-1.

*Packages to load*
```{r}
library(tidyverse)
library(testthat)
library(dplyr)
library(gapminder)
library(digest)
library(palmerpenguins)
library(commonmark)
library(devtools)
library(roxygen2)
```

###Exercise 1: Make a Function, & Exercise 2: Document your Function

This is a simple function designed to create a bar graph for in order to quickly get compare counts for a variable of interest. The graph is displayed horizontally to make room for longer variable names, which could overlap and become visually confusing on a vertical bar graph.
```{r}
#' Create a Bar Graph
#'
#' @description This function allows you to produce a simple horizontal bar graph to look at a variable of interest in a dataset. The resulting bar graph will display the count of cases within each group for the variable of interest.
#'
#' @param df The dataset containing your variable of interest
#' @param x Your variable of interest to be graphed
#'
#' @return A horizontal bar graph
#'
#' @examples
#' bar_function(penguins, penguins$species)
#' bar_function(gapminder, gapminder$continent)
bar_function <- function(df, x){
  ggplot(df, aes(x)) +
  geom_bar(fill = "azure4") +
  coord_flip() +
  theme_minimal()
}
```

###Exercise 3: Include Examples

#####Example 1:

Here is an example using the palmerspenguins::penguins dataset. Here, I specify the df as penguins, then x as penguins$species. The result is a bar graph showing counts of species fromt the penguins dataset.
```{r}
bar_function(penguins, penguins$species)
```
#####Example 2:

Here is an example using the gapminder::gapminder dataset. In this example, df has been specified as gapminder, while x has been specified at gapminder$continent. The resulting bar graph displays count for continents.
```{r}
bar_function(gapminder, gapminder$continent)
```
###Exercise 4: Test the Function

Write formal tests for your function. You should use at least three non-redundant uses of an expect_() function from the testthat package, and they should be contained in a test_that() function (or more than one). They should all pass.

Example of non-redundant inputs:

    Vector with no NA’s
    Vector that has NA’s
    Vector of a different type (if relevant)
    Vector of length 0, like numeric(0).

```{r}

test_that("Test that bar graph draws correctly", {
  bar_test <- bar_function(penguins, penguins$species)
 
   expect_doppelganger("simple bar graph",
   bar_test)
})



test_that("geom_dotplot draws correctly", {
  set.seed(112)
  dat <- data_frame(x = rnorm(20), g = rep(LETTERS[1:2], 10))

  # Basic dotplot with binning along x axis
  expect_doppelganger("basic dotplot with dot-density binning, binwidth = .4",
    ggplot(dat, aes(x)) + geom_dotplot(binwidth = .4)
  )

test_that("Testing bar graph function", {
  expect_equal(digest(bar_function(penguins, penguins$species)))
})

```

